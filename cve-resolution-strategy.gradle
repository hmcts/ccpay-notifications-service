configurations.all {
  resolutionStrategy {
    eachDependency { DependencyResolveDetails details ->
      /* JAR upgrades with latest versions for CVE fixes*/

      /* CVE-2021-27568 */
      if (details.requested.name == 'json-smart') {
        details.useVersion '2.4.7'
      }

      /* CVE-2021-28170 */
      if (details.requested.name == 'jakarta.el') {
        details.useVersion '4.0.1'

      }



      /*CVE-2021-22118*/
      if (details.requested.name == 'spring-aop' || details.requested.name == 'spring-aspects' || details.requested.name == 'spring-beans'
        || details.requested.name == 'spring-context' || details.requested.name == 'spring-core' || details.requested.name == 'spring-expression'
        || details.requested.name == 'spring-jcl' || details.requested.name == 'spring-jdbc' || details.requested.name == 'spring-orm'
        || details.requested.name == 'spring-tx' || details.requested.name == 'spring-web' || details.requested.name == 'spring-webmvc'
        || details.requested.name == 'spring-context-support' || details.requested.name == 'spring-test') {
        details.useVersion '5.3.15'
      }


      /*CVE-2021-22112 */
      if (details.requested.name == 'spring-security-config'||details.requested.name == 'spring-security-core'||details.requested.name == 'spring-security-crypto'
        ||details.requested.name == 'spring-security-web' ||details.requested.name == 'spring-security-oauth2-client' ||details.requested.name == 'spring-security-oauth2-core' ||
        details.requested.name == 'spring-security-oauth2-jose' || details.requested.name == 'spring-security-oauth2-resource-server' || details.requested.name == 'spring-security-core') {
        details.useVersion '5.6.1'
      }


      /* CVE-2021-22096 */
      if (details.requested.name == 'spring-core') {
        details.useVersion '5.3.15'
      }


      /* CVE-2021-41079, CVE-2021-33037, CVE-2021-30640, CVE-2021-42340 */
      if (details.requested.name == 'tomcat-embed-core' || details.requested.name == 'tomcat-embed-el' || details.requested.name == 'tomcat-embed-websocket') {
        details.useVersion '9.0.58'
      }

      /* CVE-2021-42550 */
      if (details.requested.name == 'logback-core' || details.requested.name == 'logback-classic') {
        details.useVersion '1.2.10'
      }

      /* CVE-2020-15522 */
      if (details.requested.name == 'bcprov-jdk15on') {
        details.useVersion '1.67'
      }

      /* CVE-2020-22044 */
      if (details.requested.name == 'spring-cloud-openfeign-core' || details.requested.name == 'spring-cloud-starter-openfeign') {
        details.useVersion '3.0.6'
      }

      /* CVE-2022-21724 */
      if (details.requested.name == 'postgresql' && details.requested.group == 'org.postgresql') {
        details.useVersion '42.3.3'
      }

      if (details.requested.name == 'spring-security-config' || details.requested.name == 'spring-security-core' || details.requested.name == 'spring-security-crypto'
        || details.requested.name == 'spring-security-web') {
        details.useVersion '5.4.7'
      }

      /*CVE-2022-25857, CVE-2022-38749, CVE-2022-38750, CVE-2022-38751 */
      if (details.requested.name == 'snakeyaml') {
        details.useVersion '1.32'
      }


      if (details.requested.name == 'spring-security-config' || details.requested.name == 'spring-security-core' || details.requested.name == 'spring-security-crypto'
        || details.requested.name == 'spring-security-web') {
        details.useVersion '5.4.7'
      }

      /*CVE-2022-25857, CVE-2022-38749, CVE-2022-38750, CVE-2022-38751 */
      if (details.requested.name == 'snakeyaml') {
        details.useVersion '1.32'
      }

      /*
           * CVE-2022-42252, CVE-2021-43980
           * */
      if (details.requested.name == 'tomcat-embed-core' || details.requested.name == 'tomcat-embed-websocket') {
        details.useVersion '9.0.68'
      }

      /*
       * CVE-2023-24998
      * */
      if (details.requested.name == 'commons-fileupload') {
        details.useVersion '1.5'
      }
      /* START OF WORK ???? */

//
//
//      /*
//      * CVE-2021-29425 Version 1.1** isn't available at all????
//      * */
//      if (details.requested.name == 'fortify-client') {
//        details.useVersion '3.1.1'
//      }
//
//      /*
//      * Also CVE-2022-25647 Generating same error????
//      * */
//      if (details.requested.name == 'fortify-client') {
//        details.useVersion '3.1.1'
//      }
//
//      /*
//     * Also CVE-2021-29425 Generating same error????
//     * */
//      if (details.requested.name == 'fortify-client') {
//        details.useVersion '3.1.1'
//      }
//
//      /*
//      * Also CVE-2020-13956 Generating same error????
//      * */
//      if (details.requested.name == 'fortify-client') {
//        details.useVersion '3.1.1'
//      }

      /*
      * CVE-2022-22965, CVE-2022-22950, CVE-2022-22971, CVE-2022-22968, CVE-2022-22970
      * */
      if (details.requested.name == 'spring-aop') {
        details.useVersion '5.3.26'
      }

      /*
      * CVE-2022-22965, CVE-2022-22950, CVE-2022-22971, CVE-2022-22968, CVE-2022-22970
      * */
      if (details.requested.name == 'spring-aspects') {
        details.useVersion '5.3.26'
      }

      /*
      * CVE-2022-22965, CVE-2022-22950, CVE-2022-22971, CVE-2022-22968, CVE-2022-22970
      * */
      if (details.requested.name == 'spring-beans') {
        details.useVersion '5.3.26'
      }

      /*
      * CVE-2022-22965, CVE-2022-22950, CVE-2022-22971, CVE-2022-22968, CVE-2022-22970
      * */
      if (details.requested.name == 'spring-context') {
        details.useVersion '5.3.26'
      }

      /*
      * CVE-2022-22965, CVE-2022-22950, CVE-2022-22971, CVE-2022-22968, CVE-2022-22970
      * */
      if (details.requested.name == 'spring-core') {
        details.useVersion '5.3.26'
      }

      /*
      * CVE-2022-22965, CVE-2022-22950, CVE-2022-22971, CVE-2022-22968, CVE-2022-22970
      * */
      if (details.requested.name == 'spring-expression') {
        details.useVersion '5.3.26'
      }

      /*
      * CVE-2022-22965, CVE-2022-22950, CVE-2022-22971, CVE-2022-22968, CVE-2022-22970
      * */
      if (details.requested.name == 'spring-jcl') {
        details.useVersion '5.3.26'
      }

      /*
      * CVE-2022-22965, CVE-2022-22950, CVE-2022-22971, CVE-2022-22968, CVE-2022-22970
      * */
      if (details.requested.name == 'spring-jdbc') {
        details.useVersion '5.3.26'
      }

      /*
      * CVE-2022-22965, CVE-2022-22950, CVE-2022-22971, CVE-2022-22968, CVE-2022-22970
      * */
      if (details.requested.name == 'spring-orm') {
        details.useVersion '5.3.26'
      }

      /*
      * CVE-2022-22978, CVE-2022-22976
      * */
      if (details.requested.name == 'spring-security-config') {
        details.useVersion '5.4.11'
      }

      /*
      * CVE-2022-22978, CVE-2022-22976
      * */
      if (details.requested.name == 'spring-security-core') {
        details.useVersion '5.4.11'
      }

      /*
      * CVE-2022-22978, CVE-2022-22976
      * */
      if (details.requested.name == 'spring-security-crypto') {
        details.useVersion '5.4.11'
      }

      /*
      * CVE-2022-22969
      * */
      if (details.requested.name == 'spring-security-oauth2') {
        details.useVersion '2.5.2.RELEASE'
      }

      /*
      * CVE-2022-22978, CVE-2022-31692, CVE-2022-31690, CVE-2022-22976
      * */
      if (details.requested.name == 'spring-security-oauth2-client') {
        details.useVersion '5.6.10'
      }

      /*
      * CVE-2022-22978, CVE-2022-31692, CVE-2022-31690, CVE-2022-22976
      * */
      if (details.requested.name == 'spring-security-oauth2-core') {
        details.useVersion '5.6.10'
      }

      /*
      * CVE-2022-22978, CVE-2022-31692, CVE-2022-31690, CVE-2022-22976
      * */
      if (details.requested.name == 'spring-security-oauth2-jose') {
        details.useVersion '5.6.10'
      }

      /*
      * CVE-2022-22978, CVE-2022-31692, CVE-2022-31690, CVE-2022-22976
      * */
      if (details.requested.name == 'spring-security-oauth2-resource-server') {
        details.useVersion '5.6.10'
      }

      /*
      * CVE-2022-22978, CVE-2022-22976
      * */
      if (details.requested.name == 'spring-security-web') {
        details.useVersion '5.4.11'
      }

      /*
      * CVE-2022-22965, CVE-2022-22950, CVE-2022-22971, CVE-2022-22968, CVE-2022-22970
      * */
      if (details.requested.name == 'spring-tx') {
        details.useVersion '5.3.26'
      }

      /*
      * CVE-2022-22965, CVE-2022-22950, CVE-2022-22971, CVE-2022-22968, CVE-2022-22970
      * */
      if (details.requested.name == 'spring-webmvc') {
        details.useVersion '5.3.26'
      }

      /*
      * CVE-2022-45143
      * */
      if (details.requested.name == 'tomcat-embed-core') {
        details.useVersion '9.0.73'
      }

      /*
      * CVE-2022-45143
      * */
      if (details.requested.name == 'tomcat-embed-websocket') {
        details.useVersion '9.0.73'
      }


      /* CVE fix with latest version ends here */
    }
  }
}
